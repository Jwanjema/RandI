services:
  # Django Backend Service (Docker)
  - type: web
    name: RandI
    runtime: docker
    dockerfilePath: ./backend/Dockerfile
    dockerContext: ./backend
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: rental-db
          property: connectionString
      - key: SECRET_KEY
        generateValue: true
      - key: DEBUG
        value: False
      - key: ALLOWED_HOSTS
        value: randi-kwbw.onrender.com,.onrender.com
      - key: CORS_ALLOWED_ORIGINS
        value: https://rental-frontend-u8t6.onrender.com
      - key: CSRF_TRUSTED_ORIGINS
        value: https://randi-kwbw.onrender.com,https://rental-frontend-u8t6.onrender.com
      - key: CREATE_DEMO_USERS
        value: true
    buildFilter:
      paths:
        - backend/**

  # React Frontend Service (Docker)
  - type: web
    name: rental-frontend
    runtime: docker
    dockerfilePath: ./frontend/Dockerfile
    dockerContext: ./frontend
    envVars:
      - key: REACT_APP_API_URL
        value: https://randi-kwbw.onrender.com/api
    buildFilter:
      paths:
        - frontend/**

# PostgreSQL Database
databases:
  - name: rental-db
    databaseName: rental_db
    user: rental_user
    plan: free
